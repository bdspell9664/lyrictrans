<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>歌词翻译工具</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="title-section">
                    <h1>歌词翻译工具</h1>
                    <p>支持多种歌词格式，借助AI轻松翻译</p>
                </div>
                <div class="version-info">
                    <span>版本: 1.0.0</span>
                </div>
            </div>
        </header>

        <main>
            <!-- 文件上传区域 -->
            <section class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <div class="upload-icon">📁</div>
                        <h3>拖放歌词文件到此处</h3>
                        <p>或</p>
                        <button class="btn" id="browseBtn">浏览文件</button>
                        <input type="file" id="fileInput" accept=".lrc,.srt,.ass,.ssa,.txt" multiple style="display: none;">
                    </div>
                </div>
            </section>
            
            <!-- 音频上传区域 -->
            <section class="audio-upload-section" style="margin-top: 1rem;">
                <div class="audio-upload-content">
                    <h3>上传原歌曲文件（用于生成逐字歌词）</h3>
                    <div class="audio-upload-area" id="audioUploadArea">
                        <div class="audio-upload-icon">🎵</div>
                        <p>拖放音频文件到此处</p>
                        <p>或</p>
                        <button class="btn" id="audioBrowseBtn">浏览音频文件</button>
                        <input type="file" id="audioInput" accept=".mp3,.wav,.ogg,.flac,.ala,.caac,.dd,.aac,.m4a,.wma,.aiff,.ape" style="display: none;">
                    </div>
                    <div class="audio-info" id="audioInfo" style="margin-top: 1rem; display: none;">
                        <span id="audioFileName"></span>
                        <button class="btn btn-small" id="removeAudioBtn">移除</button>
                    </div>
                    <div class="sync-options" style="margin-top: 1rem;">
                        <label for="sourceLang">源语言：</label>
                        <select id="sourceLang">
                            <option value="auto">自动检测</option>
                            <option value="zh-CN">中文</option>
                            <option value="en">英语</option>
                            <option value="ja">日语</option>
                            <option value="ko">韩语</option>
                            <option value="fr">法语</option>
                            <option value="de">德语</option>
                            <option value="es">西班牙语</option>
                        </select>
                        <button class="btn btn-primary" id="generateWordByWordBtn" style="margin-left: 1rem;">生成逐字歌词</button>
                    </div>
                </div>
            </section>

            <!-- 文件列表 -->
            <section class="file-list-section" id="fileListSection" style="display: none;">
                <h2>已上传文件</h2>
                <ul id="fileList"></ul>
            </section>

            <!-- 翻译设置 -->
            <section class="settings-section" id="settingsSection" style="display: none;">
                <h2>翻译设置</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="translationApi">翻译服务：</label>
                        <select id="translationApi">
                        <option value="baidu">百度翻译API</option>
                    </select>
                    </div>
                    <div class="setting-item">
                        <label for="sourceLang">源语言：</label>
                        <select id="sourceLang">
                            <option value="auto">自动检测</option>
                            <option value="zh-CN">中文</option>
                            <option value="en">英语</option>
                            <option value="ja">日语</option>
                            <option value="ko">韩语</option>
                            <option value="fr">法语</option>
                            <option value="de">德语</option>
                            <option value="es">西班牙语</option>
                            <option value="ru">俄语</option>
                            <option value="pt">葡萄牙语</option>
                            <option value="it">意大利语</option>
                            <option value="nl">荷兰语</option>
                            <option value="sv">瑞典语</option>
                            <option value="no">挪威语</option>
                            <option value="da">丹麦语</option>
                            <option value="fi">芬兰语</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="targetLang">目标语言：</label>
                        <select id="targetLang">
                            <option value="zh-CN">中文</option>
                            <option value="en">英语</option>
                            <option value="ja">日语</option>
                            <option value="ko">韩语</option>
                            <option value="fr">法语</option>
                            <option value="de">德语</option>
                            <option value="es">西班牙语</option>
                            <option value="ru">俄语</option>
                            <option value="pt">葡萄牙语</option>
                            <option value="it">意大利语</option>
                            <option value="nl">荷兰语</option>
                            <option value="sv">瑞典语</option>
                            <option value="no">挪威语</option>
                            <option value="da">丹麦语</option>
                            <option value="fi">芬兰语</option>
                        </select>
                    </div>
                </div>
                <div class="settings-options">
                    <label class="checkbox-option">
                        <input type="checkbox" id="includeOriginal" checked>
                        包含原文（双语模式）
                    </label>
                </div>
                <div class="batch-options" style="margin: 1rem 0;">
                    <button class="btn btn-primary" id="translateBtn">开始翻译</button>
                    <button class="btn btn-primary" id="batchTranslateBtn" style="margin-left: 1rem;">批量翻译</button>
                    <button class="btn btn-primary" id="batchDownloadBtn" style="margin-left: 1rem;">批量下载</button>
                </div>
            </section>

            <!-- 翻译结果 -->
            <section class="result-section" id="resultSection" style="display: none;">
                <h2>翻译结果</h2>
                <div class="result-tabs">
                    <button class="tab-btn active" data-tab="original">原文</button>
                    <button class="tab-btn" data-tab="translated">译文</button>
                    <button class="tab-btn" data-tab="wordByWord">逐字歌词</button>
                </div>
                <div class="result-content">
                    <div class="tab-panel active" id="originalPanel">
                        <pre id="originalLyrics"></pre>
                    </div>
                    <div class="tab-panel" id="translatedPanel">
                        <pre id="translatedLyrics"></pre>
                    </div>
                    <div class="tab-panel" id="wordByWordPanel">
                        <!-- 逐字歌词播放区域 -->
                        <div class="word-by-word-player">
                            <div class="karaoke-display">
                                <div class="karaoke-text" id="karaokeText">
                                    <p class="current-line" id="currentLine">-- 等待播放 --</p>
                                    <p class="next-line" id="nextLine"></p>
                                </div>
                            </div>
                            
                            <!-- 音频控制 -->
                            <div class="audio-controls">
                                <button class="audio-btn" id="playBtn">▶ 播放</button>
                                <button class="audio-btn" id="pauseBtn" style="display: none;">⏸ 暂停</button>
                                <button class="audio-btn" id="stopBtn">⏹ 停止</button>
                                <input type="range" id="progressSlider" class="progress-slider" min="0" max="100" value="0">
                                <span class="time-display" id="timeDisplay">00:00 / 00:00</span>
                                <select id="playbackSpeed" class="speed-select">
                                    <option value="0.5">0.5x</option>
                                    <option value="0.75">0.75x</option>
                                    <option value="1" selected>1.0x</option>
                                    <option value="1.25">1.25x</option>
                                    <option value="1.5">1.5x</option>
                                    <option value="2">2.0x</option>
                                </select>
                            </div>
                            
                            <!-- 逐字编辑区域 -->
                            <div class="word-editor-section" style="margin-top: 2rem;">
                                <h3>歌词编辑</h3>
                                <div class="timeline-editor" id="timelineEditor">
                                    <!-- 时间轴编辑界面将通过JS动态生成 -->
                                </div>
                                <div class="editor-controls">
                                    <button class="btn btn-small" id="saveTimelineBtn">保存时间轴</button>
                                    <button class="btn btn-small" id="resetTimelineBtn">重置时间轴</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="download-options" style="margin: 1rem 0;">
                    <label for="outputFormat">输出格式：</label>
                    <select id="outputFormat">
                        <option value="auto">自动（保持原格式）</option>
                        <option value="lrc">LRC</option>
                        <option value="srt">SRT</option>
                        <option value="txt">TXT</option>
                        <option value="ass">ASS</option>
                        <option value="ssa">SSA</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="downloadBtn">下载翻译文件</button>
            </section>
        </main>

        <!-- 加载状态 -->
        <div class="loading" id="loading" style="display: none;">
            <div class="loading-content">
                <div class="spinner"></div>
                <p>正在翻译，请稍候...</p>
            </div>
        </div>
        
        <!-- 下载进度 -->
        <div class="download-progress" id="downloadProgress" style="display: none;">
            <div class="download-progress-content">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="progressText">正在下载...</p>
            </div>
        </div>
        
        <!-- 通知 -->
        <div class="notification" id="notification" style="display: none;">
            <div class="notification-content">
                <span id="notificationText"></span>
                <button class="notification-close" id="notificationClose">×</button>
            </div>
        </div>
        
        <!-- 控制台 -->
        <div class="console-container">
            <div class="console-header">
                <h3>控制台</h3>
                <div class="console-controls">
                    <span id="proxyStatus" class="status-indicator">代理状态：未检测</span>
                    <button id="toggleConsole" class="btn btn-small">收起</button>
                    <button id="clearLog" class="btn btn-small">清空日志</button>
                </div>
            </div>
            <div class="console-body" id="consoleBody">
                <div id="consoleLog" class="console-log"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript 文件 -->
    <script src="md5.js"></script>
    <script src="js/services/aiService.js"></script>
    <script src="js/utils/file.js"></script>
    <script src="js/parsers/lrcParser.js"></script>
    <script src="js/parsers/srtParser.js"></script>
    <script src="js/parsers/assParser.js"></script>
    <script src="js/parsers/txtParser.js"></script>
    <script src="js/parsers/parserManager.js"></script>
    <script src="js/app.js?v=3"></script>
</body>
</html>