<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>歌词翻译工具</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="title-section">
                    <h1>歌词翻译工具</h1>
                    <p>支持多种歌词格式，借助AI轻松翻译</p>
                </div>
                <div class="auth-section">
                    <div id="userInfo" style="display: none;">
                        <span id="userName"></span>
                        <button class="btn btn-small" id="logoutBtn">退出</button>
                        <button class="btn btn-small" id="adminBtn" style="display: none;">管理</button>
                    </div>
                    <div id="loginForm" style="display: flex; gap: 0.5rem;">
                        <input type="text" id="loginUsername" placeholder="用户名" style="padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                        <input type="password" id="loginPassword" placeholder="密码" style="padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">
                        <button class="btn btn-small" id="loginBtn">登录</button>
                        <button class="btn btn-small" id="registerBtn">注册</button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <!-- 文件上传区域 -->
            <section class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <div class="upload-icon">📁</div>
                        <h3>拖放歌词文件到此处</h3>
                        <p>或</p>
                        <button class="btn" id="browseBtn">浏览文件</button>
                        <input type="file" id="fileInput" accept=".lrc,.srt,.ass,.ssa,.txt" multiple style="display: none;">
                    </div>
                </div>
            </section>
            
            <!-- 音频上传区域 -->
            <section class="audio-upload-section" style="margin-top: 1rem;">
                <div class="audio-upload-content">
                    <h3>上传原歌曲文件（用于生成逐字歌词）</h3>
                    <div class="audio-upload-area" id="audioUploadArea">
                        <div class="audio-upload-icon">🎵</div>
                        <p>拖放音频文件到此处</p>
                        <p>或</p>
                        <button class="btn" id="audioBrowseBtn">浏览音频文件</button>
                        <input type="file" id="audioInput" accept=".mp3,.wav,.ogg,.flac,.ala,.caac,.dd,.aac,.m4a,.wma,.aiff,.ape" style="display: none;">
                    </div>
                    <div class="audio-info" id="audioInfo" style="margin-top: 1rem; display: none;">
                        <span id="audioFileName"></span>
                        <button class="btn btn-small" id="removeAudioBtn">移除</button>
                    </div>
                    <div class="sync-options" style="margin-top: 1rem;">
                        <label for="sourceLang">源语言：</label>
                        <select id="sourceLang">
                            <option value="auto">自动检测</option>
                            <option value="zh-CN">中文</option>
                            <option value="en">英语</option>
                            <option value="ja">日语</option>
                            <option value="ko">韩语</option>
                            <option value="fr">法语</option>
                            <option value="de">德语</option>
                            <option value="es">西班牙语</option>
                        </select>
                        <button class="btn btn-primary" id="generateWordByWordBtn" style="margin-left: 1rem;">生成逐字歌词</button>
                    </div>
                </div>
            </section>

            <!-- 文件列表 -->
            <section class="file-list-section" id="fileListSection" style="display: none;">
                <h2>已上传文件</h2>
                <ul id="fileList"></ul>
            </section>

            <!-- 翻译设置 -->
            <section class="settings-section" id="settingsSection" style="display: none;">
                <h2>翻译设置</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="translationApi">翻译服务：</label>
                        <select id="translationApi">
                        <option value="mock">模拟翻译</option>
                        <option value="baidu">百度翻译API</option>
                        <option value="openai">OpenAI API</option>
                        <option value="deepl">DeepL API</option>
                        <option value="google">Google Translate API</option>
                    </select>
                    </div>
                    <div class="setting-item" id="apiKeyField" style="display: none;">
                        <label for="apiKey">API 密钥：</label>
                        <input type="password" id="apiKey" placeholder="输入API密钥">
                    </div>
                    <div class="setting-item">
                        <label for="sourceLang">源语言：</label>
                        <select id="sourceLang">
                            <option value="auto">自动检测</option>
                            <option value="zh-CN">中文</option>
                            <option value="en">英语</option>
                            <option value="ja">日语</option>
                            <option value="ko">韩语</option>
                            <option value="fr">法语</option>
                            <option value="de">德语</option>
                            <option value="es">西班牙语</option>
                            <option value="ru">俄语</option>
                            <option value="pt">葡萄牙语</option>
                            <option value="it">意大利语</option>
                            <option value="nl">荷兰语</option>
                            <option value="sv">瑞典语</option>
                            <option value="no">挪威语</option>
                            <option value="da">丹麦语</option>
                            <option value="fi">芬兰语</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="targetLang">目标语言：</label>
                        <select id="targetLang">
                            <option value="zh-CN">中文</option>
                            <option value="en">英语</option>
                            <option value="ja">日语</option>
                            <option value="ko">韩语</option>
                            <option value="fr">法语</option>
                            <option value="de">德语</option>
                            <option value="es">西班牙语</option>
                            <option value="ru">俄语</option>
                            <option value="pt">葡萄牙语</option>
                            <option value="it">意大利语</option>
                            <option value="nl">荷兰语</option>
                            <option value="sv">瑞典语</option>
                            <option value="no">挪威语</option>
                            <option value="da">丹麦语</option>
                            <option value="fi">芬兰语</option>
                        </select>
                    </div>
                </div>
                <div class="settings-options">
                    <label class="checkbox-option">
                        <input type="checkbox" id="includeOriginal" checked>
                        包含原文（双语模式）
                    </label>
                </div>
                <div class="batch-options" style="margin: 1rem 0;">
                    <button class="btn btn-primary" id="translateBtn">开始翻译</button>
                    <button class="btn btn-primary" id="batchTranslateBtn" style="margin-left: 1rem;">批量翻译</button>
                    <button class="btn btn-primary" id="batchDownloadBtn" style="margin-left: 1rem;">批量下载</button>
                </div>
            </section>

            <!-- 翻译结果 -->
            <section class="result-section" id="resultSection" style="display: none;">
                <h2>翻译结果</h2>
                <div class="result-tabs">
                    <button class="tab-btn active" data-tab="original">原文</button>
                    <button class="tab-btn" data-tab="translated">译文</button>
                </div>
                <div class="result-content">
                    <div class="tab-panel active" id="originalPanel">
                        <pre id="originalLyrics"></pre>
                    </div>
                    <div class="tab-panel" id="translatedPanel">
                        <pre id="translatedLyrics"></pre>
                    </div>
                </div>
                <div class="download-options" style="margin: 1rem 0;">
                    <label for="outputFormat">输出格式：</label>
                    <select id="outputFormat">
                        <option value="auto">自动（保持原格式）</option>
                        <option value="lrc">LRC</option>
                        <option value="srt">SRT</option>
                        <option value="txt">TXT</option>
                        <option value="ass">ASS</option>
                        <option value="ssa">SSA</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="downloadBtn">下载翻译文件</button>
            </section>
        </main>

        <!-- 加载状态 -->
        <div class="loading" id="loading" style="display: none;">
            <div class="loading-content">
                <div class="spinner"></div>
                <p>正在翻译，请稍候...</p>
            </div>
        </div>
        
        <!-- 管理员模态框 -->
        <div id="adminModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
            <div class="modal-content" style="background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 800px; border-radius: 8px;">
                <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2>管理员管理系统</h2>
                    <button type="button" class="close" id="closeAdminModal" style="color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="admin-tabs">
                        <button class="tab-btn active" data-tab="users">用户管理</button>
                        <button class="tab-btn" data-tab="settings">系统设置</button>
                        <button class="tab-btn" data-tab="records">翻译记录</button>
                    </div>
                    
                    <!-- 用户管理标签页 -->
                    <div class="tab-panel active" id="usersPanel">
                        <h3>用户列表</h3>
                        <div style="margin: 1rem 0;">
                            <button class="btn btn-small" id="addUserBtn">添加用户</button>
                        </div>
                        <table id="userTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background-color: #f2f2f2;">
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">ID</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">用户名</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">角色</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">创建时间</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">操作</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody">
                                <!-- 用户数据将通过JavaScript动态添加 -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 系统设置标签页 -->
                    <div class="tab-panel" id="settingsPanel">
                        <h3>系统设置</h3>
                        <div class="settings-form" style="margin: 1rem 0;">
                            <div class="setting-item" style="margin-bottom: 1rem;">
                                <label for="systemName">系统名称：</label>
                                <input type="text" id="systemName" style="padding: 0.5rem; width: 300px;">
                            </div>
                            <div class="setting-item" style="margin-bottom: 1rem;">
                                <label for="defaultTranslationApi">默认翻译服务：</label>
                                <select id="defaultTranslationApi" style="padding: 0.5rem; width: 300px;">
                                    <option value="mock">模拟翻译</option>
                                    <option value="baidu">百度翻译API</option>
                                    <option value="openai">OpenAI API</option>
                                    <option value="deepl">DeepL API</option>
                                    <option value="google">Google Translate API</option>
                                </select>
                            </div>
                            <button class="btn btn-small" id="saveSettingsBtn">保存设置</button>
                        </div>
                    </div>
                    
                    <!-- 翻译记录标签页 -->
                    <div class="tab-panel" id="recordsPanel">
                        <h3>翻译记录</h3>
                        <table id="recordsTable" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background-color: #f2f2f2;">
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">ID</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">用户</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">源语言</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">目标语言</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">翻译服务</th>
                                    <th style="padding: 8px; text-align: left; border: 1px solid #ddd;">时间</th>
                                </tr>
                            </thead>
                            <tbody id="recordsTableBody">
                                <!-- 记录数据将通过JavaScript动态添加 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript 文件 -->
    <script src="js/utils/file.js"></script>
    <script src="js/services/authService.js"></script>
    <script src="js/services/aiService.js"></script>
    <script src="js/parsers/lrcParser.js"></script>
    <script src="js/parsers/srtParser.js"></script>
    <script src="js/parsers/assParser.js"></script>
    <script src="js/parsers/txtParser.js"></script>
    <script src="js/parsers/parserManager.js"></script>
    <script src="js/app.js"></script>
</body>
</html>